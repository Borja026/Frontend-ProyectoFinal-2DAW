<!-- Importar Flatpickr para el calendario -->
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.js"></script>




<div id="partidas">
  <!-- Top zone -->
  <div>
    <div id="calendario">
      <app-calendario></app-calendario>
    </div>
    <div id="info">
      <h2>Â¿Necesitas ayuda?</h2>
      <h3>678 737 555</h3>
      <h3>607 367 494</h3>
    </div>
    <div id="leyenda">
      <img src="imgs/pistas/Leyenda_Pistas.png" alt="leyenda de las pistas" />
    </div>
  </div>

  <!-- Pistas zone -->
  <div id="pistas">
    <ng-container *ngFor="let pista of pistas; let i = index">
      <div>
        <ng-container [ngSwitch]="pista.apuntados">
          <img
            *ngSwitchCase="0"
            src="imgs/pistas/pista_verde.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
        
          <img
            *ngSwitchCase="1"
            src="imgs/pistas/pista_naranja.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
          <img
            *ngSwitchCase="2"
            src="imgs/pistas/pista_naranja.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
          <img
            *ngSwitchCase="3"
            src="imgs/pistas/pista_naranja.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
        
          <img
            *ngSwitchCase="4"
            src="imgs/pistas/pista_roja.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
        
          <img
            *ngSwitchCase="5"
            src="imgs/pistas/pista_azul.png"
            alt="Pista {{ pista.idPista }}"
            [attr.data-id]="pista.idPista"
            [attr.data-hora]="pista.hora"
            [attr.data-personas-apuntadas]="pista.apuntados"
            (click)="onImageClick($event, i)"
          />
        </ng-container>
        
        <div>{{ pista.hora }}</div>

        <ng-container *ngIf="activeIndex === i">
          <!-- Botones de apuntarse -->
          <div *ngIf="pista.apuntados < 4" [style.display]="showButtons ? 'block' : 'none'">
            <button (click)="apuntarseSolo()">Apuntarse solo</button>
            <button *ngIf="pista.apuntados <= 2" (click)="apuntarseConAmigos(1)">
              Apuntarse con <br />
              1 amigos
            </button>
            <button *ngIf="pista.apuntados <= 1" (click)="apuntarseConAmigos(2)">
              Apuntarse con <br />
              2 amigos
            </button>
            <button *ngIf="pista.apuntados === 0" (click)="reservarPistaFunction(i)">Reservar la pista</button>
            <button (click)="showButtons = false">Cancelar</button>
          </div>

          <!-- Niveles de los amigos -->
          <div [style.display]="showFriendLevels ? 'flex' : 'none'">
            <div
              class="nivelAmigos"
              *ngFor="let nivel of friendLevels; let i = index"
            >
              <div class="nivelDelAmigo">
                <label for="nivelAmigos{{ i + 1 }}">Inv. {{ i + 1 }}</label>
                <select
                  id="nivelAmigos{{ i + 1 }}"
                  name="nivelAmigos"
                  [(ngModel)]="friendLevels[i]"
                >
                  <option value="1.25">1.25</option>
                  <option value="1.50">1.50</option>
                  <option value="1.75">1.75</option>
                  <option value="2.00">2.00</option>
                  <option value="2.25">2.25</option>
                  <option value="2.50">2.50</option>
                  <option value="2.75">2.75</option>
                  <option value="3.00">3.00</option>
                  <option value="3.25">3.25</option>
                  <option value="3.50" selected>3.50</option>
                  <option value="3.75">3.75</option>
                  <option value="4.00">4.00</option>
                  <option value="4.25">4.25</option>
                  <option value="4.50">4.50</option>
                  <option value="4.75">4.75</option>
                  <option value="5.00">5.00</option>
                </select>
              </div>
            </div>
            <div>
              <button (click)="showFriendLevels = false">Cancelar</button>
              <button (click)="guardarNivelesAmigos(i)">Guardar</button>
            </div>
          </div>
        </ng-container>
      </div>
    </ng-container>
  </div>
</div>
